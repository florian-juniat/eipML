{"ast":null,"code":"import _slicedToArray from\"/home/flo/HeriotWatt/E-commerce/CW/ecomm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Container,Typography,Button,Grid}from'@material-ui/core';import{Link}from'react-router-dom';import{useHistory}from'react-router-dom';import CartItem from'./CartItem/CartItem';import useStyles from'./styles';import axios from'axios';import{loadStripe}from\"@stripe/stripe-js\";var Cart=function Cart(_ref){var cart=_ref.cart,onUpdateCartQty=_ref.onUpdateCartQty,onRemoveFromCart=_ref.onRemoveFromCart,onEmptyCart=_ref.onEmptyCart,token=_ref.token,setTotalItem=_ref.setTotalItem,totalItem=_ref.totalItem;var classes=useStyles();var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loadProduct=_useState2[0],setLoadProduct=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),productt=_useState4[0],setProduct=_useState4[1];if(token==\"\"){history.push('/ecomm/signin');}if(loadProduct==false){axios.get('https://back-ecommerce01.herokuapp.com/paiement/basket',{headers:{'Authorization':token}}).then(function(res){setProduct(res.data);}).catch(function(error){console.log(\"=======> problem get products\");});setLoadProduct(true);}var refresh=function refresh(){axios.get('https://back-ecommerce01.herokuapp.com/paiement/basket',{headers:{'Authorization':token}}).then(function(res){setProduct(res.data);}).catch(function(error){});};var handleEmptyCart=function handleEmptyCart(){return onEmptyCart();};var renderEmptyCart=function renderEmptyCart(){return/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle1\"},\"You have no items in your shopping cart,\",/*#__PURE__*/React.createElement(Link,null,/*#__PURE__*/React.createElement(\"a\",{className:classes.astext,onClick:function onClick(){return history.push('/ecomm/');},variant:\"body2\"},\"start adding some\")),\"!\");};if(!loadProduct)return'Loading';var calculatePrice=function calculatePrice(){var ret=0;productt.map(function(el){ret=ret+el.price;});return ret;};var handleCheckout=function handleCheckout(){axios.post('https://back-ecommerce01.herokuapp.com/paiement/checkout',{product:productt},{headers:{'Authorization':token}}).then(function(res){var stripe=window.Stripe(\"pk_test_51IW08HH1tQZu8g0MReJAaUbqYR30vtIS3iQOHDE6WJzbToUm4n3sdRyGM7BcFbgEDuJbIXyiJlNweKFByDt3Qs0o00SSVE8rzy\");if(stripe){stripe.redirectToCheckout({sessionId:res.data.id});}});};var renderCart=function renderCart(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Grid,{container:true,spacing:3},productt.map(function(lineItem){return/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:4,key:lineItem.id},/*#__PURE__*/React.createElement(CartItem,{totalItem:totalItem,setTotalItem:setTotalItem,refresh:refresh,token:token,item:lineItem,onUpdateCartQty:onUpdateCartQty,onRemoveFromCart:onRemoveFromCart}));})),/*#__PURE__*/React.createElement(\"div\",{className:classes.cardDetails},/*#__PURE__*/React.createElement(Typography,{variant:\"h4\"},\"Subtotal: $\",calculatePrice()),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button,{className:classes.checkoutButton,onClick:handleCheckout,size:\"large\",type:\"button\",variant:\"contained\",color:\"primary\"},\"Checkout\"))));};return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(\"div\",{className:classes.toolbar}),/*#__PURE__*/React.createElement(Typography,{className:classes.title,variant:\"h3\",gutterBottom:true},\"Your Shopping Cart\"),!productt.length?renderEmptyCart():renderCart());};export default Cart;","map":{"version":3,"sources":["/home/flo/HeriotWatt/E-commerce/CW/ecomm/src/components/Cart/Cart.jsx"],"names":["React","useState","Container","Typography","Button","Grid","Link","useHistory","CartItem","useStyles","axios","loadStripe","Cart","cart","onUpdateCartQty","onRemoveFromCart","onEmptyCart","token","setTotalItem","totalItem","classes","history","loadProduct","setLoadProduct","productt","setProduct","push","get","headers","then","res","data","catch","error","console","log","refresh","handleEmptyCart","renderEmptyCart","astext","calculatePrice","ret","map","el","price","handleCheckout","post","product","stripe","window","Stripe","redirectToCheckout","sessionId","id","renderCart","lineItem","cardDetails","checkoutButton","toolbar","title","length"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport { Container, Typography, Button, Grid } from '@material-ui/core';\nimport { Link } from 'react-router-dom';\nimport { useHistory } from 'react-router-dom';\n\nimport CartItem from './CartItem/CartItem';\nimport useStyles from './styles';\nimport axios from 'axios';\n\nimport { loadStripe } from \"@stripe/stripe-js\";\n\n\nconst Cart = ({ cart, onUpdateCartQty, onRemoveFromCart, onEmptyCart , token, setTotalItem, totalItem}) => {\n  const classes = useStyles();\n  const history = useHistory();\n\n  const [loadProduct, setLoadProduct] = useState(false)\n  const [productt, setProduct] = useState([])\n\n\n  if (token == \"\") {\n    history.push('/ecomm/signin')\n  }\n\n\n  if (loadProduct == false) {\n    axios.get('https://back-ecommerce01.herokuapp.com/paiement/basket', {\n    headers: {\n      'Authorization': token\n    }}).then(res => {\n        setProduct(res.data)\n    }).catch(function (error) {\n      console.log(\"=======> problem get products\")\n    });\n    setLoadProduct(true)\n  }\n\n  const refresh = () => {\n    axios.get('https://back-ecommerce01.herokuapp.com/paiement/basket', {\n    headers: {\n      'Authorization': token\n    }}).then(res => {\n        setProduct(res.data)\n    }).catch(function (error) {\n    });\n  }\n\n  const handleEmptyCart = () => onEmptyCart();\n\n  const renderEmptyCart = () => (\n    <Typography variant=\"subtitle1\">You have no items in your shopping cart, \n        <Link>\n              <a className={classes.astext} onClick={() => history.push('/ecomm/')} variant=\"body2\">\n                {\"start adding some\"}\n              </a>\n        </Link>!\n    </Typography>\n  );\n\n  if (!loadProduct) return 'Loading';\n\n  const calculatePrice = () => {\n    var ret = 0\n    productt.map(el => {\n      ret = ret + el.price\n    })\n    return ret\n  }\n\n  const handleCheckout = () => {\n\n    axios.post('https://back-ecommerce01.herokuapp.com/paiement/checkout', {product: productt\n    }, {\n        headers: {\n          'Authorization': token\n    }}).then(res => {\n      const stripe = window.Stripe(\"pk_test_51IW08HH1tQZu8g0MReJAaUbqYR30vtIS3iQOHDE6WJzbToUm4n3sdRyGM7BcFbgEDuJbIXyiJlNweKFByDt3Qs0o00SSVE8rzy\")\n\n      if (stripe) {\n          stripe.redirectToCheckout({ sessionId: res.data.id })\n      }\n    })\n  }\n\n  const renderCart = () => (\n    <>\n      <Grid container spacing={3}>\n        {productt.map((lineItem) => (\n          <Grid item xs={12} sm={4} key={lineItem.id}>\n            <CartItem totalItem={totalItem} setTotalItem={setTotalItem} refresh={refresh} token={token} item={lineItem} onUpdateCartQty={onUpdateCartQty} onRemoveFromCart={onRemoveFromCart} />\n          </Grid>\n        ))}\n      </Grid>\n      <div className={classes.cardDetails}>\n        <Typography variant=\"h4\">Subtotal: ${calculatePrice()}</Typography>\n        <div>\n          <Button className={classes.checkoutButton} onClick={handleCheckout} size=\"large\" type=\"button\" variant=\"contained\" color=\"primary\">Checkout</Button>\n        </div>\n      </div>\n    </>\n  );\n\n  return (\n    <Container>\n      <div className={classes.toolbar} />\n      <Typography className={classes.title} variant=\"h3\" gutterBottom>Your Shopping Cart</Typography>\n      { !productt.length ? renderEmptyCart() : renderCart() }\n    </Container>\n  );\n};\n\nexport default Cart;\n"]},"metadata":{},"sourceType":"module"}