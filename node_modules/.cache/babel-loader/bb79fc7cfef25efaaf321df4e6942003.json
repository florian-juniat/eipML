{"ast":null,"code":"import _regeneratorRuntime from\"/home/flo/HeriotWatt/E-commerce/CW/ecomm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/flo/HeriotWatt/E-commerce/CW/ecomm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/flo/HeriotWatt/E-commerce/CW/ecomm/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{CssBaseline}from'@material-ui/core';import{BrowserRouter as Router,Switch,Route}from'react-router-dom';import{Navbar,Products,Cart,Checkout}from'./components';import{commerce}from'./lib/commerce';import SignUp from'./components/Sign/SignUp';import SignIn from'./components/Sign/SignIn';import PrivateRoute from'./components/Private/Privateroute';var App=function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),mobileOpen=_React$useState2[0],setMobileOpen=_React$useState2[1];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),cart=_useState4[0],setCart=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),order=_useState6[0],setOrder=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),errorMessage=_useState8[0],setErrorMessage=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),token=_useState10[0],setToken=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),totalItem=_useState12[0],setTotalItem=_useState12[1];var fetchProducts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$commerce$produ,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return commerce.products.list();case 2:_yield$commerce$produ=_context.sent;data=_yield$commerce$produ.data;setProducts(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchProducts(){return _ref.apply(this,arguments);};}();var fetchCart=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=setCart;_context2.next=3;return commerce.cart.retrieve();case 3:_context2.t1=_context2.sent;(0,_context2.t0)(_context2.t1);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchCart(){return _ref2.apply(this,arguments);};}();var handleAddToCart=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(productId,quantity){var item;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return commerce.cart.add(productId,quantity);case 2:item=_context3.sent;setCart(item.cart);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function handleAddToCart(_x,_x2){return _ref3.apply(this,arguments);};}();var handleUpdateCartQty=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(lineItemId,quantity){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return commerce.cart.update(lineItemId,{quantity:quantity});case 2:response=_context4.sent;setCart(response.cart);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function handleUpdateCartQty(_x3,_x4){return _ref4.apply(this,arguments);};}();var handleRemoveFromCart=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(lineItemId){var response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return commerce.cart.remove(lineItemId);case 2:response=_context5.sent;setCart(response.cart);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function handleRemoveFromCart(_x5){return _ref5.apply(this,arguments);};}();var handleEmptyCart=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return commerce.cart.empty();case 2:response=_context6.sent;setCart(response.cart);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function handleEmptyCart(){return _ref6.apply(this,arguments);};}();var refreshCart=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var newCart;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return commerce.cart.refresh();case 2:newCart=_context7.sent;setCart(newCart);case 4:case\"end\":return _context7.stop();}}},_callee7);}));return function refreshCart(){return _ref7.apply(this,arguments);};}();var handleCaptureCheckout=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(checkoutTokenId,newOrder){var incomingOrder;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return commerce.checkout.capture(checkoutTokenId,newOrder);case 3:incomingOrder=_context8.sent;setOrder(incomingOrder);refreshCart();_context8.next=11;break;case 8:_context8.prev=8;_context8.t0=_context8[\"catch\"](0);setErrorMessage(_context8.t0.data.error.message);case 11:case\"end\":return _context8.stop();}}},_callee8,null,[[0,8]]);}));return function handleCaptureCheckout(_x6,_x7){return _ref8.apply(this,arguments);};}();useEffect(function(){fetchProducts();fetchCart();},[]);var handleDrawerToggle=function handleDrawerToggle(){return setMobileOpen(!mobileOpen);};/*\n\n  <Switch>\n          \n          <Route exact path=\"/ecomm\">\n            <Products products={products} onAddToCart={handleAddToCart} handleUpdateCartQty />\n          </Route>\n          <Route exact path=\"/signup\">\n            <SignUp />\n          </Route>\n          <Route exact path=\"/signin\">\n            <SignIn />\n          </Route>\n          <Route exact path=\"/cart\">\n            <Cart cart={cart} onUpdateCartQty={handleUpdateCartQty} onRemoveFromCart={handleRemoveFromCart} onEmptyCart={handleEmptyCart} />\n          </Route>\n          <Route path=\"/checkout\" exact>\n            <Checkout cart={cart} order={order} onCaptureCheckout={handleCaptureCheckout} error={errorMessage} />\n          </Route>\n        </Switch>\n        */return/*#__PURE__*/React.createElement(Router,null,/*#__PURE__*/React.createElement(\"div\",{style:{display:'flex'}},/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(Navbar,{totalItems:totalItem,handleDrawerToggle:handleDrawerToggle,token:token}),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/ecomm/signup\"},/*#__PURE__*/React.createElement(SignUp,{setToken:setToken})),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/ecomm/signin\"},/*#__PURE__*/React.createElement(SignIn,{setToken:setToken})),/*#__PURE__*/React.createElement(Route,{token:token,exact:true,path:\"/ecomm\"},/*#__PURE__*/React.createElement(Products,{setTotalItem:setTotalItem,token:token,products:products,onAddToCart:handleAddToCart,handleUpdateCartQty:true})),/*#__PURE__*/React.createElement(Route,{token:token,exact:true,path:\"/ecomm/cart\"},/*#__PURE__*/React.createElement(Cart,{totalItem:totalItem,setTotalItem:setTotalItem,token:token,cart:cart,onUpdateCartQty:handleUpdateCartQty,onRemoveFromCart:handleRemoveFromCart,onEmptyCart:handleEmptyCart})))));};export default App;","map":{"version":3,"sources":["/home/flo/HeriotWatt/E-commerce/CW/ecomm/src/App.js"],"names":["React","useState","useEffect","CssBaseline","BrowserRouter","Router","Switch","Route","Navbar","Products","Cart","Checkout","commerce","SignUp","SignIn","PrivateRoute","App","mobileOpen","setMobileOpen","products","setProducts","cart","setCart","order","setOrder","errorMessage","setErrorMessage","token","setToken","totalItem","setTotalItem","fetchProducts","list","data","fetchCart","retrieve","handleAddToCart","productId","quantity","add","item","handleUpdateCartQty","lineItemId","update","response","handleRemoveFromCart","remove","handleEmptyCart","empty","refreshCart","refresh","newCart","handleCaptureCheckout","checkoutTokenId","newOrder","checkout","capture","incomingOrder","error","message","handleDrawerToggle","display"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { CssBaseline } from '@material-ui/core';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport { Navbar, Products, Cart, Checkout } from './components';\nimport { commerce } from './lib/commerce';\n\nimport SignUp from './components/Sign/SignUp'\nimport SignIn from './components/Sign/SignIn'\nimport PrivateRoute from './components/Private/Privateroute'\n\nconst App = () => {\n  const [mobileOpen, setMobileOpen] = React.useState(false);\n  const [products, setProducts] = useState([]);\n  const [cart, setCart] = useState({});\n  const [order, setOrder] = useState({});\n  const [errorMessage, setErrorMessage] = useState('');\n  const [token, setToken] = useState(\"\")\n  const [totalItem, setTotalItem] = useState(0)\n\n  const fetchProducts = async () => {\n    const { data } = await commerce.products.list();\n    setProducts(data);\n  };\n\n  const fetchCart = async () => {\n    setCart(await commerce.cart.retrieve());\n  };\n\n  const handleAddToCart = async (productId, quantity) => {\n    const item = await commerce.cart.add(productId, quantity);\n\n    setCart(item.cart);\n  };\n\n  const handleUpdateCartQty = async (lineItemId, quantity) => {\n    const response = await commerce.cart.update(lineItemId, { quantity });\n\n    setCart(response.cart);\n  };\n\n  const handleRemoveFromCart = async (lineItemId) => {\n    const response = await commerce.cart.remove(lineItemId);\n\n    setCart(response.cart);\n  };\n\n  const handleEmptyCart = async () => {\n    const response = await commerce.cart.empty();\n\n    setCart(response.cart);\n  };\n\n  const refreshCart = async () => {\n    const newCart = await commerce.cart.refresh();\n\n    setCart(newCart);\n  };\n\n  const handleCaptureCheckout = async (checkoutTokenId, newOrder) => {\n    try {\n      const incomingOrder = await commerce.checkout.capture(checkoutTokenId, newOrder);\n\n      setOrder(incomingOrder);\n\n      refreshCart();\n    } catch (error) {\n      setErrorMessage(error.data.error.message);\n    }\n  };\n\n  useEffect(() => {\n    fetchProducts();\n    fetchCart();\n  }, []);\n\n  const handleDrawerToggle = () => setMobileOpen(!mobileOpen);\n\n  /*\n\n  <Switch>\n          \n          <Route exact path=\"/ecomm\">\n            <Products products={products} onAddToCart={handleAddToCart} handleUpdateCartQty />\n          </Route>\n          <Route exact path=\"/signup\">\n            <SignUp />\n          </Route>\n          <Route exact path=\"/signin\">\n            <SignIn />\n          </Route>\n          <Route exact path=\"/cart\">\n            <Cart cart={cart} onUpdateCartQty={handleUpdateCartQty} onRemoveFromCart={handleRemoveFromCart} onEmptyCart={handleEmptyCart} />\n          </Route>\n          <Route path=\"/checkout\" exact>\n            <Checkout cart={cart} order={order} onCaptureCheckout={handleCaptureCheckout} error={errorMessage} />\n          </Route>\n        </Switch>\n        */\n\n  return (\n    <Router>\n      <div style={{ display: 'flex' }}>\n        <CssBaseline />\n        <Navbar totalItems={totalItem} handleDrawerToggle={handleDrawerToggle} token={token} />\n        <Switch>\n\n          <Route exact path=\"/ecomm/signup\">\n            <SignUp setToken={setToken}/>\n          </Route>\n          <Route exact path=\"/ecomm/signin\">\n            <SignIn setToken={setToken}/>\n          </Route>\n          \n          <Route token={token} exact path=\"/ecomm\">\n            <Products setTotalItem={setTotalItem} token={token} products={products} onAddToCart={handleAddToCart} handleUpdateCartQty />\n          </Route>\n          \n          <Route token={token} exact path=\"/ecomm/cart\">\n            <Cart totalItem={totalItem} setTotalItem={setTotalItem} token={token} cart={cart} onUpdateCartQty={handleUpdateCartQty} onRemoveFromCart={handleRemoveFromCart} onEmptyCart={handleEmptyCart} />\n          </Route>\n        </Switch>\n        \n      </div>\n    </Router>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}